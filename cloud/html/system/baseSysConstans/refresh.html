<div class="content_center">
	<div class="content_center_content">
		<form class="form-horizontal" name="edit_form" role="form"  id="edit_form">
				<!-- <div class="form-group">
					<label class="control-label col-xs-4 col-sm-3"><span class="red"></span>系统名称：</label>
					<div class="col-xs-8 col-sm-7">
						<select name="type" id="type">
							<option value='1'>系统名称</option>
							<option value='2'>缓存表达式</option>
						</select>
					</div>
				</div> -->
				<div class="border marginTop" style="min-height: 176px;">
					<div class="content_center_title">方式一</div>
					
					<div class="form-group">
						<label class="control-label col-xs-4 col-sm-4"><span class="red"></span>系统名称：</label> 
						<div class="col-xs-5 col-sm-5">
							<select name="sysCache" id="sysCache"></select>
						</div>
						<button type="button" class="btn btn-primary col-xs-2 col-sm-2" onclick="_doSubmit(1);">确定</button>
					</div>
				</div>
				<div class="border marginTop">
					<div class="content_center_title">方式二</div>
					
					<div class="form-group">
						<label class="control-label col-xs-4 col-sm-4"><span class="red"></span>系统缓存表达式：</label>
						<div class="col-xs-5 col-sm-5">
							<input type="text" class="form-control" id="paramName" name="paramName" placeholder="请输入系统缓存表达式"  autocomplete="off">
						</div>
						<button type="button" class="btn btn-primary col-xs-2 col-sm-2" onclick="_doSubmit(2);">确定</button>
					</div>
				</div>
				
			<!-- 隐藏域 -->
			<input id="edit_id" name="id" class="form-control" type="hidden">
		</form>
	</div>
</div>
<script type="text/javascript">
$(function(){
	listOption($('#sysCache'),SYS_CACHE_NAME);
	$('#sysCache').comboSelect();
	_validateForm();
});

//初始化验证框架
function _validateForm(){
	//进行表单验证
   	$('#edit_form').bootstrapValidator({
		message: '输入值不合法',
        feedbackIcons: {valid: 'glyphicon glyphicon-ok',invalid: 'glyphicon glyphicon-remove',validating: 'glyphicon glyphicon-refresh'},
        fields: {
     	}
	});
}

//提交表单
function _doSubmit(type){
	var bv = $('#edit_form').data('bootstrapValidator').validate();
	if (!bv.isValid()) {//验证不通过
		return;
	}
	var paramForm = $("#edit_form").serializeArray();
	var params = {};
	$.each(paramForm, function(i, param){
		params[param.name]=$.trim(param.value);
	});
	var sysCache = params.sysCache;
	var paramName = params.paramName;
	if(type == 1) {
		key = sysCache;
	} else if(type == 2) {
		key = paramName;
	}
	if(type == 1) {
		if(key == '' || key == null){
			Ewin.alert({
            message: '请选择对应系统缓存'
			});
			return;
		}

	} else if(type == 2) {
		if(key == null || key == ''){
			Ewin.alert({
            message: '系统缓存表达式不能为空'
			});
			return;
		}
		if(key.length > 128){
			Ewin.alert({
            message: '系统缓存表达式长度限制 1 ~ 128 之间'
			});
			return;
		}
		
	}
	
	sendAjax('POST', host_url + "/cloud-web/pubSysConstans/clearCache", { 
	          'key': key
	      }, function (res) {
	          if (res.retCode == SUCCESS_CODE) {
	          	Ewin.alert({ message: '恭喜你，操作成功！' }).on(function(e){
	      			if(e){
	      				$('#edit_form').parents('.modal').modal('hide');
	      			}
	      		});
	          } else {
	              Ewin.alert({
	                  message: res.retMsg
	              });
	          }
	      });
}
</script> 

