<link rel="stylesheet" href="../../../css/lib/bootstrap-datetimepicker.min.css" />
<div class="content_center">
	<div class="content_center_content">
		<!--查询条件-->
		<div class="content_center_condition">
			<form id="memberAcctForm" name="memberAcctForm" role="form" class="form-inline">
					<div class="form-group">
					<label class="control-label">平台号：</label>
					<input type="text" name="cusCode" class="form-control" type="text" placeholder="平台号" autocomplete="off">
				</div>
				<div class="form-group">
					<label class="control-label">平台名称：</label>
					<input type="text" name="cusName" class="form-control" type="text" placeholder="平台名称" autocomplete="off">
				</div>
				<div class="form-group">
					<label class="control-label">账单日期：</label>
					<input id="memberAcct_createTime" type="text" name="tradeDate" class="form-control form_datetime" readonly="readonly">
				</div>
				<div class="form-group pull-right">
					<button id="memberAcctButton" type="button" class="btn btn-primary refreshBtn">查询</button>
					<button type="button" class="btn btn-default resetButton" onclick="memberAcct_resetButton()">重置</button>
				</div>
				<div class="clearfix"></div>
			</form>
		</div>
		<div class="content_center_table">
			<table cellpadding="0" cellspacing="0" border="0" id="memberAcctTable"
				   class="table table-bordered table-hover"></table>
		</div>
	</div>
</div>
<script type="text/javascript">
    $(function () {
        memberAcctTable();
		$('#memberAcct_createTime').val(sys_formatDate(new Date(), 'yyyy-MM-dd'));
		$('#memberAcct_createTime').datetimepicker({
			format: 'yyyy-mm-dd',
			autoclose: true,
			language: 'zh-CN',
			minView: 'month',
			pickerPosition: "bottom-right",
		});
    });
	// 搜索
	$("#memberAcctButton").click(function () {
		$("#memberAcctTable").bootstrapTable('destroy');
		memberAcctTable();
	});
	function memberAcct_resetButton(){
		$('#memberAcctForm')[0].reset();
		$('#memberAcct_createTime').val(sys_formatDate(new Date(), 'yyyy-MM-dd'));
	}
    /*表格加载*/
    function memberAcctTable() {
		var mydate = new Date();
		var totalTraDate = $('#memberAcct_createTime').val();
		var str = "" + mydate.getFullYear() + "-";
		str += (mydate.getMonth()+1) + "-";
		str += mydate.getDate();
		var tady=new Date(str.replace("-", "/").replace("-", "/"));
		var t2 = new Date(totalTraDate.replace("-", "/").replace("-", "/"));
		if(t2 <tady){
			var url = '/cloud-web/cusAcctInfoHistory/pageList';
		}else{
			var url = '/cloud-web/cusAcctInfo/pageList';
		}
        $('#memberAcctTable').bootstrapTable({
            url: host_url + url,
            method: 'GET',
            dataType: "json",
            contentType: "application/x-www-form-urlencoded;charset=UTF-8",
            pagination: true, //在表格底部显示分页工具栏
            pageNumber: 1,
			pageList: [20, 50, 100],
            clickToSelect: true,
            sidePagination: "server",//表格分页的位置
            cache: false,//是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
            locale: 'zh-CN',//中文支持
            queryParamsType: 'limit',
            queryParams: function (params) {
                params.pageSize = params.limit;                        //页面大小
                params.page = (params.offset / params.limit) + 1;   	 //页码
                params._sys_login_token = _get_sys_login_token();
				
                var paramForm = $("#memberAcctForm").serializeArray();
                $.each(paramForm, function (i, param) {
                    params[param.name] = $.trim(param.value);
                });
                params.status=100;
                return params;
            }, //参数
            columns: [
                {
                    title: '序号', width: 30, align: "center", valign: "middle",
                    formatter: function (value, row, index) {
                        var options = $('#memberAcctTable').bootstrapTable('getOptions');
                        return (options.pageNumber - 1) * options.pageSize + index + 1;
                    }
                },
				{field: 'cusCode', title: '平台号', width: 80, align: "center", valign: "middle"},
                {field: 'cusName', title: '平台名称', width: 100, align: "center", valign: "middle"},
				{field:'dayRecAmt',title:'当日收款金额(元)',width:80,align:"right",valign:"middle",
				formatter:function(value,row,index){return formatterMoney(value);}},
				{field:'dayPayAmt',title:'当日付款金额(元)',width:80,align:"right",valign:"middle",
				formatter:function(value,row,index){return formatterMoney(value);}},
				{field:'totalRecAmt',title:'累计收款金额(元)',width:80,align:"right",valign:"middle",
				formatter:function(value,row,index){return formatterMoney(value);}},
				{field:'totalPayAmt',title:'累计付款金额(元)',width:80,align:"right",valign:"middle",
				formatter:function(value,row,index){return formatterMoney(value);}},
                {field: 'createTime', title: '账单日期', width: 100, align: "center", valign: "middle",
                    formatter: function (value, row, index) {
                		if(t2 <tady){
                			return row.tradeDate; 
                		}else{
                			return $('#memberAcct_createTime').val();
                		}
                        
                    }
                },
            ],
            onLoadSuccess: function (res) {},
        });
    }
</script> 